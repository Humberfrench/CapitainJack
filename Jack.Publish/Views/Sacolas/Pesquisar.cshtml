@using Jack.Application.ViewModel;
@using Jack.Extensions
@model IEnumerable<SacolaViewModel>

@Styles.Render("~/Content/plugins/dataTables/dataTablesStyles")
@Styles.Render("~/plugins/awesomeCheckboxStyles")
@{
    ViewBag.Title = "Sacolas";
    Layout = "~/Views/Shared/_Layout2.cshtml";
    IEnumerable<SelectListItem> nivelLista = ViewBag.Nivel as IEnumerable<SelectListItem>;
    IEnumerable<SelectListItem> kitLista = ViewBag.Kit as IEnumerable<SelectListItem>;
    IEnumerable<SelectListItem> familiaLista = ViewBag.Familia as IEnumerable<SelectListItem>;
    var disabled = "";
}


<div class="wrapper wrapper-content animated fadeInRight">
    <div class="row">
        <div class="col-lg-12">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <h5>Sacolas</h5>
                </div>
                <div class="ibox-content">
                    <div class="row">
                        <div class="col-lg-1">&nbsp;</div>
                        <div class="col-lg-2">
                            <label id="labelAno" for="Ano">Ano</label>
                            <select name="Ano" id="Ano" class="form-control m-b">
                                <option value="0">Ano</option>
                                <option value="2014">2014</option>
                                <option value="2015">2015</option>
                                <option value="2016">2016</option>
                                <option value="2017">2017</option>
                                <option value="2018">2018</option>
                                <option value="2019">2019</option>
                                <option value="2020">2020</option>
                                <option value="2021">2021</option>
                                <option value="2022">2022</option>
                            </select>
                        </div>
                        <div class="col-lg-4">
                            <label id="labelNivel" for="Nivel">Nível</label>
                            @Html.DropDownList("Nivel", nivelLista, new { @id = "Nivel", @class = "form-control m-b" })
                            <input type="hidden" value="@ViewBag.NivelId" id="NivelId" name="NivelId" />
                        </div>
                        <div class="col-lg-4">
                            <label id="labelKit" for="Kit">Kit</label>
                            @Html.DropDownList("Kit", kitLista, new { @id = "Kit", @class = "form-control m-b" })
                            <input type="hidden" value="@ViewBag.KitId" id="KitId" name="KitId" />
                        </div>
                        <div class="col-lg-1">&nbsp;</div>
                    </div>
                    <div class="row">
                        <div class="col-lg-1">&nbsp;</div>
                        <div class="col-lg-7">
                            <label id="labelFamilia" for="Familia">Família</label>
                            @Html.DropDownList("Familia", familiaLista, new { @id = "Familia", @class = "form-control m-b" })
                            <input type="hidden" value="@ViewBag.FamiliaId" id="NivelId" name="NivelId" />
                        </div>

                        <div class="col-lg-1" style="text-align:center;">
                            <br />
                            <button id="Pesquisar" class="btn btn-primary btn-md" data-toggle="tooltip" data-placement="top" title="Pesquisar" onclick="return Colaborador.Pesquisar();">
                                <i class="glyphicon glyphicon-search"></i>
                            </button>
                        </div>
                        <div class="col-lg-2">
                            <div class="widget style1 navy-bg">
                                <div class="row vertical-align">
                                    <div class="col-xs-3">
                                        <i class="fa fa-user fa-3x"></i>
                                    </div>
                                    <div class="col-xs-9 text-right">
                                        <h2 class="font-bold">@Model.ToList().Count</h2>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-1">&nbsp;</div>
                    </div>
                </div>
                <div class="ibox-content">
                    <div class="project-list">
                        <table class="table table-striped table-hover table-responsive" id="TableSacolaPesquisa">
                            <tbody>
                                @foreach (var item in Model)
                                {
                                    disabled = "";
                                    var colaborador = "Sem Colaborador";
                                    var verBotaoColaborador = "";
                                    var colaboradorObj = item.Crianca.Colaboradores.FirstOrDefault(c => c.Ano == ViewBag.Ano);
                                    if (colaboradorObj != null)
                                    {
                                        verBotaoColaborador = "disabled=disabled";
                                        colaborador = colaboradorObj.Colaborador.Nome;
                                    }
                                    <tr>
                                        <td class="project-status">
                                            <span class="badge badge-success">@item.Codigo</span>
                                        </td>
                                        <td class="project-status">
                                            <span class="badge badge-success">@item.SacolaFamilia</span>
                                        </td>
                                        <td class="project-title">
                                            <strong>Criança: </strong>@item.Crianca.Nome
                                            <br />
                                            <small><strong>Familia: </strong>@item.Familia.Nome</small>
                                            <br />
                                            <small><strong>Representada Por:</strong> @item.FamiliaRepresentante.Nome</small>
                                            <br />
                                        </td>
                                        <td class="project-title">
                                            <strong>Colaborador: </strong>@colaborador<br />
                                        </td>
                                        <td class="project-title">
                                            <strong>Idade: </strong>@item.Crianca.IdadeNominal<br />
                                            <strong>Calçado: </strong>@item.Crianca.Calcado &nbsp;-&nbsp;
                                            <strong>Roupa: </strong>@item.Crianca.Roupa<br />
                                        </td>
                                        <td class="project-actions">
                                            <a href="#" class="btn btn-danger btn-sm" onclick="return Familia.Editar('@item.Codigo')"><i class="fa fa-print"></i> Imprimir </a>
                                            <a href="#" class="btn btn-danger btn-sm" onclick="return Familia.Editar('@item.Crianca.Codigo')" @verBotaoColaborador><i class="fa fa-heart"></i> Colaborador </a>
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section scripts
{
    @Scripts.Render("~/plugins/dataTables")
    @Scripts.Render("~/plugins/dataPicker")
    @Scripts.Render("~/plugins/Moment")
    @Scripts.Render("~/plugins/knob")
    @Scripts.Render("~/script/Sacolas/Pesquisa")
}
